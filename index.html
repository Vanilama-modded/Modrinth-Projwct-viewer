<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<meta name="theme-color" content="#30b27b"/>
<title>Modrinth Explorer</title>

<!-- PWA manifest -->
<link rel="manifest" href="data:application/manifest+json,{
  \"name\":\"Modrinth Explorer\",
  \"short_name\":\"Modrinth\",
  \"description\":\"Lightweight Modrinth client PWA\",
  \"display\":\"standalone\",
  \"theme_color\":\"#30b27b\",
  \"background_color\":\"#1e1e2e\",
  \"icons\":[
    {\"src\":\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9IiMzMEIyN0IiLz4KPHN2ZyB4PSI0OCIgeT0iNDgiIHdpZHRoPSI5NiIgaGVpZ2h0PSI5NiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJ3aGl0ZSI+CjxwYXRoIGQ9Ik0xMiAybDMuMDkgNi4yNkwyMiAyMC41aC0yMEwxMiAyWiIvPgo8L3N2Zz4KPC9zdmc+\",\"sizes\":\"192x192\",\"type\":\"image/svg+xml\"}
  ],
  \"start_url\":\"/index.html\"
}"/>

<style>
/* Basic reset */
*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif}
body{background:#1e1e2e;color:#f2f2f2;display:flex;flex-direction:column;height:100vh}
header{background:#30b27b;padding:12px 16px;color:#fff;font-weight:600;font-size:1.1em;display:flex;align-items:center;gap:8px}
header svg{width:24px;height:24px;fill:#fff}
#search{border:none;border-radius:20px;padding:8px 12px;margin-left:auto;width:160px;font-size:.9em}
#list{flex:1;overflow:auto;padding:8px}
.card{background:#252836;margin:8px 0;border-radius:12px;display:flex;gap:12px;align-items:center;padding:12px}
.card img{width:64px;height:64px;border-radius:8px;object-fit:cover;background:#444}
.card-info h3{font-size:1em;margin-bottom:4px}
.card-info p{font-size:.8em;color:#aaa}
.card button{background:#30b27b;border:none;color:#fff;padding:6px 12px;border-radius:999px;font-size:.8em;margin-left:auto}
footer{background:#252836;text-align:center;padding:8px;font-size:.7em;color:#666}
@media (prefers-color-scheme:light){
  body{background:#f5f5f5;color:#111}
  .card{background:#fff}
  header{background:#26a269}
}
</style>
</head>
<body>
<header>
  <svg viewBox="0 0 24 24"><path d="M12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2Z"/></svg>
  Modrinth Lite
  <input id="search" placeholder="Search mods..."/>
</header>

<div id="list">Loading...</div>

<footer>Made with ❤️ • Works offline when installed</footer>

<script>
/* 1. Service Worker for offline installability */
if('serviceWorker' in navigator){
  const sw=`
self.addEventListener('install',e=>e.waitUntil(
  caches.open('v1').then(c=>c.addAll(['index.html']))
));
self.addEventListener('fetch',e=>e.respondWith(
  caches.match(e.request).then(r=>r||fetch(e.request))
));`;
  const blob=new Blob([sw],{type:'application/javascript'});
  navigator.serviceWorker.register(URL.createObjectURL(blob));
}

/* 2. fetch and render projects */
const list=document.getElementById('list');
const search=document.getElementById('search');
let projects=[];

async function loadProjects(q=''){
  list.textContent='Loading...';
  const url='https://api.modrinth.com/v2/search?limit=20&index=relevance'+(q?`&query=${encodeURIComponent(q)}`:'');
  const res=await fetch(url);
  const data=await res.json();
  projects=data.hits;
  render();
}
function render(){
  list.innerHTML='';
  projects.forEach(p=>{
    const card=document.createElement('div');
    card.className='card';
    card.innerHTML=`
      <img src="${p.icon_url}" alt=""/>
      <div class="card-info">
        <h3>${p.title}</h3>
        <p>${p.description}</p>
      </div>
      <button onclick="window.open('https://modrinth.com/${p.project_type}/${p.slug}','_blank')">View</button>`;
    list.appendChild(card);
  });
  if(!projects.length)list.textContent='No results';
}
search.addEventListener('input',e=>{
  clearTimeout(search.t);
  search.t=setTimeout(()=>loadProjects(e.target.value),300);
});
loadProjects();
</script>
</body>
</html>
